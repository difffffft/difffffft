import{f as u,r as n,o as S,A,n as l,b as o,l as v,k as r,q as B,w as F,v as K,E as D}from"./index-bf47055b.js";import{a as E,c as T}from"./role-bd3b5144.js";import{u as U}from"./orgs-f0b7c58e.js";import{u as $}from"./useRefFormData-84c825c7.js";import"./lodash-3ffe41b4.js";const z={__name:"data-scope",setup(N,{expose:g}){const d=u(!1),_=u([]),i=u(),b=u(),{dataForm:t,assign:k,reset:y}=$({id:"",name:"",menu_id_list:[],org_id_list:[],data_scope:"0",remark:""}),V=s=>{d.value=!0,y(),i.value&&i.value.setCheckedKeys([]),w(s)},w=s=>U().then(e=>{_.value=e.data,s&&h(s)}),h=s=>{E(s).then(e=>{k(e.data),t.value.org_id_list.forEach(m=>{i.value.setChecked(m,!0)})})},c=()=>{t.value.org_id_list=i.value.getCheckedKeys(),T(t.value).then(()=>{D.success({message:"操作成功",duration:500,onClose:()=>{d.value=!1}})})};return g({init:V}),(s,e)=>{const m=n("el-input"),p=n("el-form-item"),C=n("BaseSelect"),x=n("el-tree"),R=n("el-form"),f=n("el-button"),L=n("el-dialog");return S(),A(L,{modelValue:d.value,"onUpdate:modelValue":e[5]||(e[5]=a=>d.value=a),title:"数据权限","close-on-click-modal":!1,width:600,draggable:""},{footer:l(()=>[o(f,{onClick:e[3]||(e[3]=a=>d.value=!1)},{default:l(()=>[v("取消")]),_:1}),o(f,{type:"primary",onClick:e[4]||(e[4]=a=>c())},{default:l(()=>[v("确定")]),_:1})]),default:l(()=>[o(R,{ref_key:"dataFormRef",ref:b,model:r(t),"label-width":"120px",onKeyup:e[2]||(e[2]=B(a=>c(),["enter"]))},{default:l(()=>[o(p,{prop:"name",label:"名称"},{default:l(()=>[o(m,{modelValue:r(t).name,"onUpdate:modelValue":e[0]||(e[0]=a=>r(t).name=a),disabled:""},null,8,["modelValue"])]),_:1}),o(p,{prop:"data_scope",label:"数据范围"},{default:l(()=>[o(C,{modelValue:r(t).data_scope,"onUpdate:modelValue":e[1]||(e[1]=a=>r(t).data_scope=a),"dict-type":"role_data_scope",placeholder:"数据范围",style:{width:"100%"}},null,8,["modelValue"])]),_:1}),F(o(p,{label:"数据权限"},{default:l(()=>[o(x,{ref_key:"orgListTree",ref:i,data:_.value,props:{label:"name",children:"children"},"node-key":"id",accordion:"","show-checkbox":""},null,8,["data"])]),_:1},512),[[K,r(t).data_scope==4]])]),_:1},8,["model"])]),_:1},8,["modelValue"])}}};export{z as default};
