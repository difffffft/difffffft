import{f as n,r as d,o as p,A as _,n as s,b as a,l as U,k as o,q as O,c as k,M as R,N as x,a3 as P,a4 as H,E as S}from"./index-bf47055b.js";import{u as T}from"./orgs-f0b7c58e.js";import{b as j}from"./post-d3d1e315.js";import{e as z}from"./role-bd3b5144.js";import{u as J}from"./useRefFormData-84c825c7.js";import"./lodash-3ffe41b4.js";const le={__name:"add-or-update",emits:["refreshDataList"],setup(Q,{expose:A,emit:q}){const i=n(!1),f=n([]),g=n([]),V=n([]),b=n(),{dataForm:t,assign:B,reset:C}=J({id:"",username:"",real_name:"",org_id:"",password:"",gender:0,email:"",mobile:"",role_id_list:[],post_id_list:[],status:1}),F=r=>{i.value=!0,C(),r&&$(r),N(),D(),E()},D=()=>j().then(r=>{f.value=r.data}),E=()=>z().then(r=>{g.value=r.data}),N=()=>T().then(r=>{V.value=r.data}),$=r=>{P(r).then(l=>{B(l.data)})},G=n({username:[{required:!0,message:"必填项不能为空",trigger:"blur"}],real_name:[{required:!0,message:"必填项不能为空",trigger:"blur"}],mobile:[{required:!0,message:"必填项不能为空",trigger:"blur"}],org_id:[{required:!0,message:"必填项不能为空",trigger:"blur"}]}),v=()=>{b.value.validate(r=>{if(!r)return!1;H(t.value).then(()=>{S.success({message:"操作成功",duration:500,onClose:()=>{i.value=!1,q("refreshDataList")}})})})};return A({init:F}),(r,l)=>{const m=d("el-input"),u=d("el-form-item"),I=d("el-tree-select"),c=d("BaseRadioGroup"),w=d("el-option"),y=d("el-select"),K=d("el-form"),L=d("el-button"),M=d("el-dialog");return p(),_(M,{modelValue:i.value,"onUpdate:modelValue":l[13]||(l[13]=e=>i.value=e),title:o(t).id?"修改":"新增","close-on-click-modal":!1,draggable:""},{footer:s(()=>[a(L,{onClick:l[11]||(l[11]=e=>i.value=!1)},{default:s(()=>[U("取消")]),_:1}),a(L,{type:"primary",onClick:l[12]||(l[12]=e=>v())},{default:s(()=>[U("确定")]),_:1})]),default:s(()=>[a(K,{ref_key:"dataFormRef",ref:b,model:o(t),rules:G.value,"label-width":"120px",onKeyup:l[10]||(l[10]=O(e=>v(),["enter"]))},{default:s(()=>[a(u,{prop:"username",label:"用户名"},{default:s(()=>[a(m,{modelValue:o(t).username,"onUpdate:modelValue":l[0]||(l[0]=e=>o(t).username=e),placeholder:"用户名",autocomplete:"new-password"},null,8,["modelValue"])]),_:1}),a(u,{prop:"real_name",label:"姓名"},{default:s(()=>[a(m,{modelValue:o(t).real_name,"onUpdate:modelValue":l[1]||(l[1]=e=>o(t).real_name=e),placeholder:"姓名"},null,8,["modelValue"])]),_:1}),a(u,{prop:"org_id",label:"所属机构"},{default:s(()=>[a(I,{modelValue:o(t).org_id,"onUpdate:modelValue":l[2]||(l[2]=e=>o(t).org_id=e),data:V.value,"value-key":"id","check-strictly":"","render-after-expand":!1,props:{label:"name",children:"children"},style:{width:"100%"}},null,8,["modelValue","data"])]),_:1}),a(u,{prop:"gender",label:"性别"},{default:s(()=>[a(c,{modelValue:o(t).gender,"onUpdate:modelValue":l[3]||(l[3]=e=>o(t).gender=e),"dict-type":"user_gender"},null,8,["modelValue"])]),_:1}),a(u,{prop:"mobile",label:"手机号"},{default:s(()=>[a(m,{modelValue:o(t).mobile,"onUpdate:modelValue":l[4]||(l[4]=e=>o(t).mobile=e),placeholder:"手机号"},null,8,["modelValue"])]),_:1}),a(u,{prop:"email",label:"邮箱"},{default:s(()=>[a(m,{modelValue:o(t).email,"onUpdate:modelValue":l[5]||(l[5]=e=>o(t).email=e),placeholder:"邮箱"},null,8,["modelValue"])]),_:1}),a(u,{prop:"password",label:"密码"},{default:s(()=>[a(m,{modelValue:o(t).password,"onUpdate:modelValue":l[6]||(l[6]=e=>o(t).password=e),type:"password",placeholder:"密码",autocomplete:"new-password"},null,8,["modelValue"])]),_:1}),a(u,{prop:"roleIdList",label:"所属角色"},{default:s(()=>[a(y,{modelValue:o(t).role_id_list,"onUpdate:modelValue":l[7]||(l[7]=e=>o(t).role_id_list=e),multiple:"",placeholder:"所属角色",style:{width:"100%"}},{default:s(()=>[(p(!0),k(R,null,x(g.value,e=>(p(),_(w,{key:e.id,label:e.name,value:e.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),a(u,{prop:"postIdList",label:"所属岗位"},{default:s(()=>[a(y,{modelValue:o(t).post_id_list,"onUpdate:modelValue":l[8]||(l[8]=e=>o(t).post_id_list=e),multiple:"",placeholder:"所属岗位",style:{width:"100%"}},{default:s(()=>[(p(!0),k(R,null,x(f.value,e=>(p(),_(w,{key:e.id,label:e.post_name,value:e.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),a(u,{prop:"status",label:"状态"},{default:s(()=>[a(c,{modelValue:o(t).status,"onUpdate:modelValue":l[9]||(l[9]=e=>o(t).status=e),"dict-type":"user_status"},null,8,["modelValue"])]),_:1})]),_:1},8,["model","rules"])]),_:1},8,["modelValue","title"])}}};export{le as default};
